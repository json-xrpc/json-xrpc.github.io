
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.88.1">
    <title>{JSON}.xRPC :: Transport-Agnostic Protocol</title>


    <!-- Bootstrap core CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/vs.min.css" rel="stylesheet">

    <!-- Favicons -->
<link rel="apple-touch-icon" href="/docs/5.1/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/docs/5.1/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/docs/5.1/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/docs/5.1/assets/img/favicons/manifest.json">
<link rel="mask-icon" href="/docs/5.1/assets/img/favicons/safari-pinned-tab.svg" color="#7952b3">
<link rel="icon" href="/docs/5.1/assets/img/favicons/favicon.ico">
<meta name="theme-color" content="#7952b3">


    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>

    
    <!-- Custom styles for this template -->
    <link href="/assets/product.css" rel="stylesheet">
  </head>
  <body>
    
<header class="site-header sticky-top py-1">
  <nav class="container d-flex flex-column flex-md-row justify-content-between">
    <a class="py-2" href="#" aria-label="Product">
      <img class="bi" style="width:24px;height:24px;" src="/assets/json-xrpc.svg" />
    </a>
    <a class="py-2 d-none d-md-inline-block" href="#features">Features</a>
    <a class="py-2 d-none d-md-inline-block" href="#spec">SPEC</a>
    <a class="py-2 d-none d-md-inline-block" href="https://github.com/json-xrpc/">github</a>
  </nav>
</header>

<main>
  <div class="position-relative overflow-hidden p-3 p-md-5 m-md-3 text-center bg-light">
    <div class="col-md-5 p-lg-5 mx-auto my-5">
      <img class="d-block mx-auto mb-4" src="/assets/json-xrpc.png" alt="" width="128" height="128">
      <h1 class="display-4 fw-normal">{<i>JSON</i>}.<em>x</em>RPC</h1>
      <p class="lead fw-normal">Bringing back the pure similicity of modern decoupled multi-tier APIs, MicroServices, Mobile and Web Apps.
      </p>
      <a class="btn btn-outline-secondary" href="#">Coming soon</a>
    </div>
    <div class="product-device shadow-sm d-none d-md-block"></div>
    <div class="product-device product-device-2 shadow-sm d-none d-md-block"></div>
  </div>

<div id="features" name="features" class="container px-4 py-5" id="hanging-icons">
    <h2 class="pb-2 border-bottom">Features</h2>
    <div class="row g-4 py-5 row-cols-1 row-cols-lg-3">
      <div class="col d-flex align-items-start">
        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
          <svg class="bi" width="1em" height="1em"><use xlink:href="#toggles2"/></svg>
        </div>
        <div>
          <h2>Transport-Agnostic Protocol</h2>
          <p>The JSON of the request and the response can be carried over a normal HTTP request/response or a websocket or even A UDP packet.</p>
          <a href="#" class="btn btn-primary">
            See How
          </a>
        </div>
      </div>
      <div class="col d-flex align-items-start">
        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
          <img class="bi" style="width:1em;height:1em" src="/assets/json-schema.svg" />
        </div>
        <div>
          <h2>Fully typed</h2>
          <p>You will get validators for free with minimal coding. JSON Schema or JSON Type Definition(RFC 8927) can be used as <abbr title="Interface Definition Language">IDL</abbr>, which will give us request validation. If you are using a typed language or language with type hints you might generate those validations from the code.</p>
          <a href="#" class="btn btn-primary">
            See How
          </a>
        </div>
      </div>
      <div class="col d-flex align-items-start">
        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
          <span class="xrpc">{<i>*</i>}</span>
        </div>
        <div>
          <h2>{<i>any</i>}.<em>x</em>RPC</h2>
          <p><span class="xrpc">{<i>any</i>}.<em>x</em>RPC</span> or <span class="xrpc">{<i>*</i>}.<em>x</em>RPC</span> means that JSON can be replaced with any JSON like serializer like <span>msgpack</span> without the need to rewrite any of your APIs.</p>
          <a href="#" class="btn btn-primary">
            See How
          </a>
        </div>
      </div>
    </div>

    <div class="row g-4 py-5 row-cols-1 row-cols-lg-3">
      <div class="col d-flex align-items-start">
        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
          <span>‚ö°</span>
        </div>
        <div>
          <h2>Fast</h2>
          <p>A multi-transport client using both WebSocket was faster than gRPC.</p>
          <a href="#" class="btn btn-primary">
            See the benchmark
          </a>
        </div>
      </div>
      <div class="col d-flex align-items-start">
        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
          <img class="bi" style="width:1em;height:1em" src="/assets/json-schema.svg" />
        </div>
        <div>
          <h2>Keep it simple</h2>
          <p>A DIY browser client can be written from scratch in ~30 lines without any dependency</p>
          <a href="#diy-client" class="btn btn-primary">
            See How
          </a>
        </div>
      </div>
      <div class="col d-flex align-items-start">
        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
          <span>üñáÔ∏è</span>
        </div>
        <div>
          <h2>Server-to-Server communications</h2>
          <p>It can be used for server-to-server microservices communications</p>
          <a href="#" class="btn btn-primary">
            See How
          </a>
        </div>
      </div>
    </div>

  </div>

<div id="spec" name="spec" class="container px-4 py-5">
    <h2 class="pb-2 border-bottom">Short description of this extension</h2>
    <div class="row">
<ul>
<li><code>"jsonrpc": "2.0"</code> is optional and ignored. No Protocol versioning, no negotiation.
<li><code>"method"`</code> in HTTP-based Transport is optional, if missing it will be read from HTTP URL like this <code>/rpc/&lt;METHOD&gt;</code>. For developers this help using Swagger/OpenAPI/Postman. For OPs this provide visibility and routing. In WS method is manadatory.
<li><code>"id"</code> according to spec if null or missing run background, if present but empty string `""` auto create id and wait for it.
<li>first level <code>"params"</code> must not start with <code>"_"</code> (any param starting with <code>"_"</code> should not reach the RPC).
<li>params starting with <code>"_"</code> are optional server-internal params, namely: <code>_ctx</code> (per-session context) and <code>_req</code> (per request context) provide state.
<li><code>"error"</code> has the following properties beside <code>"code"</code> and <code>"message"</code>
  <ul>
    <li><code>"level"</code>: an optional <code>string</code> that defaults to <code>"error"</code> but can be set <code>"warning"</code> in case of user-errors and non-code problems like validation errors.
    <li><code>"trace"</code>: an optional <code>string</code> which is the stack trace in non-production environments.
    <li><code>"data"</code>: an object with details about the error ex. the user_id. one of those properties:
    <ul><li><code>"validations"</code>: <code>Object&lt;string, Array&lt;string&gt;&gt;</code> in case of validation errors it contains a mapping of field names (properties) and their corresponding array of problems.
    </ul>
<li>TBD: bi-directional events and server push (for real-time applications like chat).
</ul>
    </div>
    <h2 class="pb-2 border-bottom">Tooling</h2>
    <div class="row">
    <ul>
    <li><code>code-extract</code> scan code signature to 
      <ul>
        <li>generate <abbr title="Interface Definition Language">IDL</abbr>.
        <li>validate requests with json schema, ajv, python dataclass (or pydantic, beartype, ...)
        <li>generate <code>swagger/openAPI/postman</code>
      </ul>
    <li><code>web client</code>
      <ul>
        <li>multi-transport client (tries to establish websocket, and can use normal HTTP req/res mean while)
        <li><code>form2json</code> serialize the HTML form into a JSON and submit it
        <li><code>json2json</code> with <a href="https://stedolan.github.io/jq/">jQ-like</a> functional programming and data flow.
        <li><code>json2dom</code> and <code>json2str</code> (for SSR) with mustache-like template</code> 
        <li><code>json.dom_ops</code> template (replace, appent, prepend), add_class, remove_class, toggle_class, set_attr
      </ul>
    </ul>
    </div>


    <h2 class="pb-2 border-bottom">Example Requests</h2>

<ul class="nav nav-tabs" id="reqTab" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="req0-tab" data-bs-toggle="tab" data-bs-target="#req0-tab-pane" type="button" role="tab" aria-controls="req0-tab-pane" aria-selected="true">Formal Request</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="req-tab" data-bs-toggle="tab" data-bs-target="#req-tab-pane" type="button" role="tab" aria-controls="req-tab-pane" aria-selected="true">Simple Extended Request</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="failed-tab" data-bs-toggle="tab" data-bs-target="#failed-tab-pane" type="button" role="tab" aria-controls="failed-tab-pane" aria-selected="false">Simple Extended Failed Request</button>
  </li>
</ul>
<div class="tab-content" id="reqTabContent">
  <div class="tab-pane fade show active" id="req0-tab-pane" role="tabpanel" aria-labelledby="req0-tab" tabindex="0">
<pre><code class="language-http">
POST /rpc/ HTTP/1.1
Host: example.org
Content-Type: application/json; charset=utf-8

{
   "jsonrpc": "2.0",
   "id": "7cc337d3-77fb-4fa8-a9e6-f909f5d7600b",
   "method": "book.list",
   "params": {
       "page":1,
       "per_page":10
   }
}
</code></pre>

<pre><code class="language-http">
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{
   "jsonrpc": "2.0",
   "id": "7cc337d3-77fb-4fa8-a9e6-f909f5d7600b",
   "result": {
       "count": 35,
       "items": [
           {"id": 1, "title": "Alice in Wonderland"}
       ]
   }
}
</code></pre>

<pre><code class="language-http">
HTTP/1.1 400 OK
Content-Type: application/json; charset=utf-8

{
   "jsonrpc": "2.0",
   "id": "7cc337d3-77fb-4fa8-a9e6-f909f5d7600b",
   "error": {
       "code": -32000,
       "message": "per-page can't be 0",
   }
}
</code></pre>


  </div>

  <div class="tab-pane fade" id="req-tab-pane" role="tabpanel" aria-labelledby="req-tab" tabindex="0">
<pre><code class="language-http">
POST /rpc/book.list HTTP/1.1
Host: example.org
Content-Type: application/json; charset=utf-8

{
   "params": {
       "page":1,
       "per_page":10
   }
}
</code></pre>

<pre><code class="language-http">
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{
   "result": {
       "count": 35,
       "items": [
           {"id": 1, "title": "Alice in Wonderland"}
       ]
   }
}
</code></pre>

  </div>
  <div class="tab-pane fade" id="failed-tab-pane" role="tabpanel" aria-labelledby="failed-tab" tabindex="0">
  
<pre><code class="language-http">
POST /rpc/book.list HTTP/1.1
Host: example.org
Content-Type: application/json; charset=utf-8

{
   "params": {
       "page":"abc",
       "per_page":10
   }
}
</code></pre>

<pre><code class="language-http">
HTTP/1.1 400 OK
Content-Type: application/json; charset=utf-8

{
   "error": {
       "level": "error", // or warning
       "errorcode": "integer-parse-error", // ENUM
       "message": "could not parse integer [abc]", // human
       "data": {
           "validations": {
               "page": ["must be integer"]
           }
       },
       "trace": "" // only in development mode / debug mode
   }
}
</code></pre>
  
  </div>
</div>

</div>



<div class="container px-4 py-5" id="hanging-icons">
    <h2 class="pb-2 border-bottom">Server Sample Codes</h2>

<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="ts-tab" data-bs-toggle="tab" data-bs-target="#ts-tab-pane" type="button" role="tab" aria-controls="ts-tab-pane" aria-selected="true">TypeScript</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="js-tab" data-bs-toggle="tab" data-bs-target="#js-tab-pane" type="button" role="tab" aria-controls="js-tab-pane" aria-selected="true">JavaScript</button>
  </li>

  <li class="nav-item" role="presentation">
    <button class="nav-link" id="py-tab" data-bs-toggle="tab" data-bs-target="#py-tab-pane" type="button" role="tab" aria-controls="py-tab-pane" aria-selected="false">Python</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="php-tab" data-bs-toggle="tab" data-bs-target="#php-tab-pane" type="button" role="tab" aria-controls="php-tab-pane" aria-selected="false">PHP</button>
  </li>
</ul>
<div class="tab-content" id="myTabContent">


  <div class="tab-pane fade show active" id="ts-tab-pane" role="tabpanel" aria-labelledby="ts-tab" tabindex="0">
<pre><code class="language-typescript">
// book.ts
import {validate, validate_int, validate_min, validate_max, CodedError} from "xrpc_utils"

@validate({
    page: validate_int,
    per_page: [validate_int, validate_min(1), validate_max(100)],
})
export function list({page: number, per_page: number}) {
    throw new CodedError("not-imp", "not implemented");
    return {
      "count": 35,
      "items": [
        {"id": 1, "title": "Alice in Wonderland"},
      ],
    };
}

</code></pre>

  </div>

    <div class="tab-pane fade" id="js-tab-pane" role="tabpanel" aria-labelledby="js-tab" tabindex="0">
  <pre><code class="language-javascript">
  // book.js
  import {add_validator, validate_int, validate_min, validate_max, CodedError} from "xrpc_utils"
  
  export function list({page: number, per_page: number}) {
      throw new CodedError("not-imp", "not implemented");
      return {
        "count": 35,
        "items": [
           {"id": 1, "title": "Alice in Wonderland"},
        ],
      };
  }
  add_validator(list, "page", validate_int)
  add_validator(list, "per_page", [validate_int, validate_min(1), validate_max(100)])
  </code></pre>
  
    </div>
  

  <div class="tab-pane fade" id="py-tab-pane" role="tabpanel" aria-labelledby="py-tab" tabindex="0">
  
<pre><code class="language-python">
# book.py
from xrpc_utils import (
    CodedError,
    validate,
    validate_int,
    validate_min, validate_max, 
)

@validate({
    "per_page": [validate_min(1), validate_max(100)],
})
def get_list(page: int=1, per_page: int=10):
    raise CodedError("not-imp", "not implemented")
    return {
        "count": 35,
        "items": [
           {"id": 1, "title": "Alice in Wonderland"},
        ]
    }
</code></pre>
  
  </div>
  <div class="tab-pane fade" id="php-tab-pane" role="tabpanel" aria-labelledby="php-tab" tabindex="0">

  <pre><code class="language-php">
&lt;?php
// Book.php
class Book {
  public static function list(int $page=1, int $per_page=10) {
    throw new CodedError("not-imp", "not implemented");
    return [
        "count"=> 35,
        "items"=> [
           ["id"=> 1, "title"=> "Alice in Wonderland"],
        ]
    ];
  }
}
</code></pre>

  </div>
</div>

</div>

<div id="diy-client" name="diy-client" class="container px-4 py-5" id="hanging-icons">
  <h2 class="pb-2 border-bottom">DIY Browser Client</h2>
Code that called the <code>book.get_list</code> RPC defined above can be used like this:
  <pre><code class="language-javascript"></code>
  async function on_clicked() {
    let res = await rpc_call("book.get_list", {page:1});
  }
  </code></pre>

  A fully functional client with error handling can be written in ~30 lines like this:
    <pre><code class="language-javascript">
      function throw_parsed(parsed) {
        const err = new Error(parsed.error.message);
        err.code = parsed.error.codename;
        err.validations = parsed.error.validations;
        throw err;
      }
      async function rpc_call(method, params) {
        const body = {"jsonrpc": "2.0", "params": params || {}};
        const res = await fetch(`/rpc/${method}`, {
            method: "POST",
            headers: {
                "Accept": "application/json",
                "Content-Type": "application/json",
            },
            body: JSON.stringify(body),
        });
        let parsed;
        if (!res.ok) {
            if (res.headers.get("content-type")=="application/json") {
                const text = await res.text();
                parsed = JSON.parse(text);
                throw_parsed(parsed)
            }
            throw new Error("req failed");
        }
        try {
            const text = await res.text();
            parsed = JSON.parse(text);
        } catch (e) {
            throw new Error("req failed");
        }
        if (parsed.error) {
            throw_parsed(parsed);
        }
        return parsed.result;
    }
    </code></pre>


</div>



</main>

<footer class="container py-5">
  <div class="row">
    <div class="col-12 col-md">
      <span class="xrpc">{<i>JSON</i>}.<em>x</em>RPC</span>
      <small class="d-block mb-3 text-muted">&copy; 2022</small>
    </div>
    <div class="col-6 col-md">
      <h5>Demos</h5>
      <ul class="list-unstyled text-small">
        <li><a class="link-secondary" href="#">TypeScript</a></li>
        <li><a class="link-secondary" href="#">Python</a></li>
        <li><a class="link-secondary" href="#">PHP</a></li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>Tutorials</h5>
      <ul class="list-unstyled text-small">
        <li><a class="link-secondary" href="#">TypeScript</a></li>
        <li><a class="link-secondary" href="#">Python</a></li>
        <li><a class="link-secondary" href="#">PHP</a></li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>Resources</h5>
      <ul class="list-unstyled text-small">
        <li><a class="link-secondary" href="#">Videos</a></li>
        <li><a class="link-secondary" href="#">Reference</a></li>
        <li><a class="link-secondary" href="#">SPEC</a></li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>About</h5>
      <ul class="list-unstyled text-small">
        <li><a class="link-secondary" href="#">Team</a></li>
      </ul>
    </div>
  </div>
</footer>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/http.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/python.min.js"></script>




    <script>hljs.highlightAll();</script>
      
  </body>
</html>

